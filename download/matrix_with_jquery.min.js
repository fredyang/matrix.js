/*! matrix.js v0.31pre Â© Fred Yang - semanticsworks.com | www.opensource.org/licenses/mit-license.php */this.matrix||function(){var r=function(ia,B){jQuery.Deferred&&function(e,f){function o(a){return function(){for(var c=C.call(arguments),b=0;b<a.length;b++)a[b].apply(this,c)}}function r(a,c){if("string"===typeof a){if(c){for(var b=1,d=k(a);b<d.length;)n(d[b],d[b-1]),b++;a=d[d.length-1]}return B(a)}if(e.isArray(a)){var b=a,l,g=[],f,h={ok:!0};for(l=0;l<b.length;l++)f=b[l],g.push(f),d=0===l?r(f).fail(L(f,h)):d.nextLoad(f).fail(L(g.slice(),h));return w(d)}throw"resource parameter should be an array or string";
}function B(a){var c=[],b=k(a);if(1===b.length)c=M(b[0]);else{for(var d=0;d<b.length;d++)c.push(M(b[d]));c=e.when.apply(e,c)}return w(c).fail(function(){g.unload(a)})}function L(a,c){return function(){c.ok&&(g.unload(a),c.ok=!1)}}function M(a){var c=p(a);if(c){var b=m(a);if(!b){b=c.load(a);if(!b||!b.done)b=e.Deferred().resolve(a,b).promise();c.noRefCount||m(a,b)}"staticLoaded"!==b.refCount&&(b.refCount=b.refCount?b.refCount+1:1);a=b}else a=g(x(a)+".loader").nextLoad(a);return a}function m(a,c){if(a===
f)return i;if(c===f){if(1===arguments.length)return i[a];delete i[a]}else return i[a]=c}function w(a){var c=e.Deferred();a.nextLoad=function(b){var d=C.call(arguments);a.then(function(){g.apply(null,d).then(function(){c.resolve.apply(c,C.call(arguments))},function(){c.reject(b)})},function(){c.reject(b)});return w(c.promise())};a.andLoad=function(){var b=g.apply(null,arguments);return w(e.when(b,a))};return a}function k(a){return a.replace(V,"").split(W)}function N(a){a=O.exec(a.toLowerCase());return!(!a||
!(a[1]!=y[1]||a[2]!=y[2]||(a[3]||("http:"===a[1]?80:443))!=(y[3]||("http:"===y[1]?80:443))))}function z(a){D.href=X.test(a)?a:g.baseUrl+a;N(a)?a=D.href:(a=D.href,a=s(a),a=q?a+(Y.test(a)?"&":"?")+t+"="+q:a);return a}function Z(a){for(var c in a)"string"==typeof a[c]&&(a[c]=j[c][a[c]]);var b=a.staticLoaded||j.staticLoaded.returnFalse,d=a.getSource||j.getSource.getTextByAjax,l=a.compile||j.compile.globalEval,f=a.crossSiteLoad||j.crossSiteLoad.getScript,h=a.buildDependencies||j.buildDependencies.parseRequireTag,
k=a.buildUnload||j.buildUnload.parseUnloadTag;if(!l&&!f)throw"module loader must implement at least one of compile, crossSiteLoad";return function(a){var c=e.Deferred(),i=c.promise(),j;if(b(a))i.refCount="staticLoaded",c.resolve(a);else{j=g.url(a);if(!l||N(j)){if(!f)throw"loader does not support cross domain loading";if((j=f(a))&&j.done)return j;c.resolve(a,j)}else d(a).then(function(b){if(k){var d=k(b,a);d&&(m(a).unload=d)}h&&(d=h(a,b))&&n(a,d);var d=function(){var d=l&&l(a,b);setTimeout(function(){if(!c.dontResolve){c.resolve(a,
d);delete i.defer}},5)},e=n(a);e?g(e).then(d,function(){c.reject(a);delete i.defer}):d()},function(){c.reject(a);delete i.defer});E(c)||(i.defer=c)}return i}}function s(a){return""===q?a:a.replace(P,"")}function Q(a,c){var b=e.extend(!0,{},i);g.unload(a,!0);c&&c();return g(a).done(function(){for(var a in b)i[a]&&b[a]&&(i[a].refCount=b[a].refCount,i[a].url=b[a].url,i[a].moduleId=b[a].moduleId)})}function $(a,c){var b,d=(b=p(a))&&b.require&&b.require(a);if(d){b=[];for(var d=k(d),c=k(c),e=0;e<c.length;e++)d.contains(c[e])||
b.push(c[e]);return b.length?b.join():null}return c}function aa(a,c){if(a&&!c||c&&!a)return!0;if(!a&&!c)return!1;a=k(a).sort();c=k(c).sort();if(a.length!=c.length)return!0;for(var b=0;b<a.length;b++)if(a[b]!=c[b])return!0;return!1}function p(a){var c,b;for(b=F.length-1;0<=b&&!(c=F[b](a));b--);c=c||g.defaultLoader;return G[c]}function R(a,c,b){var d=m(a),e=d.defer;delete d.defer;d.unload=b;e&&e.resolve(a,c())}function S(a){e("<link href='"+g.url(a)+"' rel='stylesheet' type='text/css' loadedByMatrix='1' />").appendTo("head")}
var u={},i={},v={},A={},G={},D=document.createElement("a"),W=/,/,V=/\s+/g,C=[].slice,Y=/\?/,ba=/\.(\w+)$/,ca=/(.+)\.\w+$/,x,T,H,j,n,X=/^http[s]?:\/\/|^\//,O=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,y=O.exec(location.href.toLowerCase())||[],q="",t="v",P,I=[],J=[],K=[],h=Array.prototype,F,U={},g=window.matrix=function(a,c,b){"boolean"!==typeof a&&(b=c,c=a,a=!1);if(c)return a=a&&!e.isReady,c=r(c,b),a&&(e.holdReady(!0),c.done(function(){e.holdReady()})),c.done(da).fail(ea)};h.indexOf=h.indexOf||
function(a,c){for(var b=c||0;b<this.length;b++)if(this[b]==a)return b;return-1};h.contains=h.contains||function(a){return-1!==this.indexOf(a)};h.remove=h.remove||function(a){a=this.indexOf(a);-1!=a&&this.splice(a,1);return this};h.pushUnique=h.pushUnique||function(a){this.contains(a)||this.push(a);return this};h.merge=h.merge||function(a){if(a&&a.length)for(var c=0;c<a.length;c++)this.pushUnique(a[c]);return this};var ea=o(J),da=o(I),fa=o(K),E=e.Deferred().isResolved?function(a){return a.isResolved()}:
function(a){return"resolved"==a.state()};e.extend(g,{unload:function(a,c){var b,d;if(e.isFunction(a))c?K.remove(a):K.push(a);else if("string"===typeof a&&(a=k(a)),1!=a.length)for(b=0;b<a.length;b++)g.unload(a[b]);else if(b=a[0],(d=m(b))&&"staticLoaded"!=d.refCount){if(0===--d.refCount||c)(d=d.unload||p(b).unload)&&d(b),m(b,f),(b=n(b))&&g.unload(b,c);fa()}},url:function(a,c){if("object"===typeof a)for(var b in a)g.url(b,a[b]);else if(c===f){if(1==arguments.length)return u[a]?u[a]:(b=p(a))&&b.url?z(b.url(a)):
z(b&&b.fileExt?T(a)+"."+b.fileExt:a);delete u[a]}else{b=g.url(a);var d=z(c);b!=d&&((b=m(a))&&E(b)?Q(a,function(){u[a]=d}):u[a]=d)}},require:n=function(a,c){if("object"===typeof a)for(var b in a)a.hasOwnProperty(b)&&n(b,a[b]);else if(c===f){if(1==arguments.length){b=v[a];var d=p(a);return d&&d.require?(d=d.require(a))&&b?d+","+b:d?d:b:b}delete v[a]}else if(!0===c){if(b=(b=n(a))&&k(b)){for(var d=[],e=0;e<b.length;e++)"module"!==g.fileExt(b[e])&&d.pushUnique(g.url(b[e])),d.merge(n(b[e],!0));return d}}else{var h=
$(a,c);b=v[a];aa(h,b)&&(d=m(a),b&&d&&E(d)?Q(a,function(){v[a]=h}):v[a]=h)}},baseUrl:"",hash:function(a,c){arguments.length&&(q=!0===a?e.now():a,t=c!==f?c:t||"v",P=RegExp("[?&]"+t+"=[^&]*"));return""===q?"":t+"="+q},loader:{resolveDependencies:function(a){return function(c){var b=e.Deferred(),d=g.require(c);d?g(d).done(function(){b.resolve(c,a(c))}):b.resolve(c,a(c));return b.promise()}},set:function(a,c,b){"string"!==typeof c&&(b=c,c=null);var b=A[a]=e.extend(!0,{},A[c],b),d=e.extend(!0,{},b);e.each(["load",
"unload","url","require"],function(){var a;if(typeof d[this]=="string"&&(a=H[this][d[this]]))d[this]=a});e.isPlainObject(d.load)&&(d.load=Z(d.load));if(!e.isFunction(d.load))throw"missing load function from loader";G[a]=e.extend({},G[c],d)},get:function(a){return a?A[a]:A},commands:H={load:{},unload:{},url:{},require:{}},finders:F=[function(a){return x(a)},function(a){a=x(a);if(a=U[a])return a}],mapFileExtsToLoader:function(a,c){for(var a=k(a),b=0;b<a.length;b++)U[a[b]]=c},loadFilters:j={staticLoaded:{},
getSource:{},compile:{},crossSiteLoad:{},buildUnload:{},buildDependencies:{}}},fileExt:x=function(a){return ba.exec(a)[1]},fileName:T=function(a){return ca.exec(a)[1]},define:function(a,c,b,d){e.isFunction(c)&&(d=b,b=c,c=null);var f=m(a);if(!f){var h=e.Deferred(),f=h.promise();f.defer=h;m(a,f)}f.defer.dontResolve=!0;if(c)return n(a,c),g(c).done(function(){R(a,b,d)});R(a,b,d)},done:function(a,c){c?I.remove(a):I.push(a)},fail:function(a,c){c?J.remove(a):J.push(a)},defaultLoader:"js"});var h=g.loader.set,
ga=/<@unload>([\w\W]+?)<\/@unload>/i,ha=/<@require>([\w\W]+?)<\/@require>/i;e.extend(!0,H,{load:{cacheImage:function(a){var c=e.Deferred(),b=c.promise(),d=g.url(a),f=new Image,f=new Image;f.onload=function(){c.resolve(a,d)};f.onerror=function(){c.reject(a,d)};f.src=d;return b}},unload:{removeCssLinkTag:function(a){var c=z(g.url(a));e("link").filter(function(){return this.href===c&&e(this).attr("loadedByMatrix")}).remove()}},url:{moduleId:function(a){return a},folder:function(a){var c=p(a).fileExt,
c=c?g.fileName(a)+"."+c:a;return g.fileExt(a)+"/"+c}}});e.extend(!0,j,{staticLoaded:{returnFalse:function(){return false},hasScriptTag:function(a){return!!e("script").filter(function(){return s(this.src)===s(g.url(a))}).length},hasCssLinkTag:function(a){return!!e("link").filter(function(){return s(this.href)===s(g.url(a))&&!e(this).attr("loadedByMatrix")}).length}},getSource:{getTextByAjax:function(a){return e.ajax({url:g.url(a),dataType:"text",cache:true})}},compile:{globalEval:function(a,c){return e.globalEval(c)},
localEval:function(a,c){return eval(c)},linkCss:S},crossSiteLoad:{getScript:function(a){var c=e.Deferred(),b=c.promise();b.defer=c;e.getScript(g.url(a)).then(function(){setTimeout(function(){if(!c.dontResolve){c.resolve(a);delete b.defer}},5)},function(){c.reject(a);delete b.defer});return b},linkCss:S},buildUnload:{parseUnloadTag:function(a){return(a=ga.exec(a))&&a[1]&&new Function(a[1])}},buildDependencies:{parseRequireTag:function(a,c){var b=ha.exec(c);return b&&b[1]||null}}});h("pack",{load:g.loader.resolveDependencies(e.noop),
url:"moduleId"});h("js",{load:{staticLoaded:"hasScriptTag"},fileExt:"js"});h("loader","js",{url:"folder"});h("css",{load:{staticLoaded:"hasCssLinkTag",crossSiteLoad:"linkCss",compile:"linkCss",buildDependencies:"parseRequireTag"},unload:"removeCssLinkTag",fileExt:"css"});h("image",{load:"cacheImage",noRefCount:!0});g.loader.mapFileExtsToLoader("jpg,png,bmp,gif","image")}(jQuery);r=void 0;if(f&&(B||!f.readyState||/loaded|complete/.test(f.readyState)))f.onload=f.onreadystatechange=null,o&&f.parentNode&&
o.removeChild(f),o=f=void 0};if(this.jQuery)r();else{var f,o=document.head||document.getElementsByTagName("head")[0]||document.documentElement;f=document.createElement("script");f.src="http://code.jquery.com/jquery-latest.min.js";f.onload=f.onreadystatechange=r;o.insertBefore(f,o.firstChild)}}();
