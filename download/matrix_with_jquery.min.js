/*! matrix.js v0.31 Â© Fred Yang - semanticsworks.com | www.opensource.org/licenses/mit-license.php */this.matrix||function(){var r=function(ia,B){jQuery.Deferred&&function(e,f){function o(a){return function(){for(var b=C.call(arguments),c=0;c<a.length;c++)a[c].apply(this,b)}}function r(a,b){if("string"===typeof a){if(b){for(var c=1,d=k(a);c<d.length;)n(d[c],d[c-1]),c++;a=d[d.length-1]}return B(a)}if(e.isArray(a)){var c=a,l,g=[],f,h={ok:!0};for(l=0;l<c.length;l++)f=c[l],g.push(f),d=0===l?r(f).fail(L(f,h)):d.nextLoad(f).fail(L(g.slice(),h));return w(d)}throw"resource parameter should be an array or string";
}function B(a){var b=[],c=k(a);if(1===c.length)b=M(c[0]);else{for(var d=0;d<c.length;d++)b.push(M(c[d]));b=e.when.apply(e,b)}return w(b).fail(function(){g.unload(a)})}function L(a,b){return function(){b.ok&&(g.unload(a),b.ok=!1)}}function M(a){var b=p(a);if(b){var c=m(a);if(!c){c=b.load(a);if(!c||!c.done)c=e.Deferred().resolve(a,c).promise();b.noRefCount||m(a,c)}"staticLoaded"!==c.refCount&&(c.refCount=c.refCount?c.refCount+1:1);a=c}else a=g(x(a)+".loader").nextLoad(a);return a}function m(a,b){if(a===
f)return i;if(b===f){if(1===arguments.length)return i[a];delete i[a]}else return i[a]=b}function w(a){var b=e.Deferred();a.nextLoad=function(c){var d=C.call(arguments);a.then(function(){g.apply(null,d).then(function(){b.resolve.apply(b,C.call(arguments))},function(){b.reject(c)})},function(){b.reject(c)});return w(b.promise())};a.andLoad=function(){var c=g.apply(null,arguments);return w(e.when(c,a))};return a}function k(a){return a.replace(V,"").split(W)}function N(a){a=O.exec(a.toLowerCase());return!(!a||
!(a[1]!=y[1]||a[2]!=y[2]||(a[3]||("http:"===a[1]?80:443))!=(y[3]||("http:"===y[1]?80:443))))}function z(a){D.href=X.test(a)?a:g.baseUrl+a;N(a)?a=D.href:(a=D.href,a=s(a),a=q?a+(Y.test(a)?"&":"?")+t+"="+q:a);return a}function Z(a){for(var b in a)"string"==typeof a[b]&&(a[b]=j[b][a[b]]);var c=a.staticLoaded||j.staticLoaded.returnFalse,d=a.getSource||j.getSource.getTextByAjax,l=a.compile||j.compile.globalEval,f=a.crossSiteLoad||j.crossSiteLoad.getScript,h=a.buildDependencies||j.buildDependencies.parseRequireTag,
k=a.buildUnload||j.buildUnload.parseUnloadTag;if(!l&&!f)throw"module loader must implement at least one of compile, crossSiteLoad";return function(a){var b=e.Deferred(),i=b.promise(),j;if(c(a))i.refCount="staticLoaded",b.resolve(a);else{j=g.url(a);if(!l||N(j)){if(!f)throw"loader does not support cross domain loading";if((j=f(a))&&j.done)return j;b.resolve(a,j)}else d(a).then(function(c){if(k){var d=k(c,a);d&&(m(a).unload=d)}h&&(d=h(a,c))&&n(a,d);var d=function(){var d=l&&l(a,c);setTimeout(function(){if(!b.dontResolve){b.resolve(a,
d);delete i.defer}},5)},e=n(a);e?g(e).then(d,function(){b.reject(a);delete i.defer}):d()},function(){b.reject(a);delete i.defer});E(b)||(i.defer=b)}return i}}function s(a){return""===q?a:a.replace(P,"")}function Q(a,b){var c=e.extend(!0,{},i);g.unload(a,!0);b&&b();return g(a).done(function(){for(var a in c)i[a]&&c[a]&&(i[a].refCount=c[a].refCount,i[a].url=c[a].url,i[a].moduleId=c[a].moduleId)})}function $(a,b){var c,d=(c=p(a))&&c.require&&c.require(a);if(d){c=[];for(var d=k(d),b=k(b),e=0;e<b.length;e++)d.contains(b[e])||
c.push(b[e]);return c.length?c.join():null}return b}function aa(a,b){if(a&&!b||b&&!a)return!0;if(!a&&!b)return!1;a=k(a).sort();b=k(b).sort();if(a.length!=b.length)return!0;for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!0;return!1}function p(a){var b,c;for(c=F.length-1;0<=c&&!(b=F[c](a));c--);b=b||g.defaultLoader;return G[b]}function R(a,b,c){var d=m(a),e=d.defer;delete d.defer;d.unload=c;e&&e.resolve(a,b())}function S(a){e("<link href='"+g.url(a)+"' rel='stylesheet' type='text/css' loadedByMatrix='1' />").appendTo("head")}
var u={},i={},v={},A={},G={},D=document.createElement("a"),W=/,/,V=/\s+/g,C=[].slice,Y=/\?/,ba=/\.(\w+)$/,ca=/(.+)\.\w+$/,x,T,H,j,n,X=/^http[s]?:\/\/|^\//,O=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,y=O.exec(location.href.toLowerCase())||[],q="",t="v",P,I=[],J=[],K=[],h=Array.prototype,F,U={},g=window.matrix=function(a,b,c){"boolean"!==typeof a&&(c=b,b=a,a=!1);if(b)return a=a&&!e.isReady,b=r(b,c),a&&(e.holdReady(!0),b.done(function(){e.holdReady()})),b.done(da).fail(ea)};h.indexOf=h.indexOf||
function(a,b){for(var c=b||0;c<this.length;c++)if(this[c]==a)return c;return-1};h.contains=h.contains||function(a){return-1!==this.indexOf(a)};h.remove=h.remove||function(a){a=this.indexOf(a);-1!=a&&this.splice(a,1);return this};h.pushUnique=h.pushUnique||function(a){this.contains(a)||this.push(a);return this};h.merge=h.merge||function(a){if(a&&a.length)for(var b=0;b<a.length;b++)this.pushUnique(a[b]);return this};var ea=o(J),da=o(I),fa=o(K),E=e.Deferred().isResolved?function(a){return a.isResolved()}:
function(a){return"resolved"==a.state()};e.extend(g,{unload:function(a,b){var c,d;if(e.isFunction(a))b?K.remove(a):K.push(a);else if("string"===typeof a&&(a=k(a)),1!=a.length)for(c=0;c<a.length;c++)g.unload(a[c]);else if(c=a[0],(d=m(c))&&"staticLoaded"!=d.refCount){if(0===--d.refCount||b)(d=d.unload||p(c).unload)&&d(c),m(c,f),(c=n(c))&&g.unload(c,b);fa()}},url:function(a,b){if("object"===typeof a)for(var c in a)g.url(c,a[c]);else if(b===f){if(1==arguments.length)return u[a]?u[a]:(c=p(a))&&c.url?z(c.url(a)):
z(c&&c.fileExt?T(a)+"."+c.fileExt:a);delete u[a]}else{c=g.url(a);var d=z(b);c!=d&&((c=m(a))&&E(c)?Q(a,function(){u[a]=d}):u[a]=d)}},require:n=function(a,b){if("object"===typeof a)for(var c in a)a.hasOwnProperty(c)&&n(c,a[c]);else if(b===f){if(1==arguments.length){c=v[a];var d=p(a);return d&&d.require?(d=d.require(a))&&c?d+","+c:d?d:c:c}delete v[a]}else if(!0===b){if(c=(c=n(a))&&k(c)){for(var d=[],e=0;e<c.length;e++)"module"!==g.fileExt(c[e])&&d.pushUnique(g.url(c[e])),d.merge(n(c[e],!0));return d}}else{var h=
$(a,b);c=v[a];aa(h,c)&&(d=m(a),c&&d&&E(d)?Q(a,function(){v[a]=h}):v[a]=h)}},baseUrl:"",hash:function(a,b){arguments.length&&(q=!0===a?e.now():a,t=b!==f?b:t||"v",P=RegExp("[?&]"+t+"=[^&]*"));return""===q?"":t+"="+q},loader:{resolveDependencies:function(a){return function(b){var c=e.Deferred(),d=g.require(b);d?g(d).done(function(){c.resolve(b,a(b))}):c.resolve(b,a(b));return c.promise()}},set:function(a,b,c){"string"!==typeof b&&(c=b,b=null);var c=A[a]=e.extend(!0,{},A[b],c),d=e.extend(!0,{},c);e.each(["load",
"unload","url","require"],function(){var a;if(typeof d[this]=="string"&&(a=H[this][d[this]]))d[this]=a});e.isPlainObject(d.load)&&(d.load=Z(d.load));if(!e.isFunction(d.load))throw"missing load function from loader";G[a]=e.extend({},G[b],d)},get:function(a){return a?A[a]:A},commands:H={load:{},unload:{},url:{},require:{}},finders:F=[function(a){return x(a)},function(a){a=x(a);if(a=U[a])return a}],mapFileExtsToLoader:function(a,b){for(var a=k(a),c=0;c<a.length;c++)U[a[c]]=b},loadFilters:j={staticLoaded:{},
getSource:{},compile:{},crossSiteLoad:{},buildUnload:{},buildDependencies:{}}},fileExt:x=function(a){return ba.exec(a)[1]},fileName:T=function(a){return ca.exec(a)[1]},define:function(a,b,c,d){e.isFunction(b)&&(d=c,c=b,b=null);var f=m(a);if(!f){var h=e.Deferred(),f=h.promise();f.defer=h;m(a,f)}f.defer.dontResolve=!0;if(b)return n(a,b),g(b).done(function(){R(a,c,d)});R(a,c,d)},done:function(a,b){b?I.remove(a):I.push(a)},fail:function(a,b){b?J.remove(a):J.push(a)},defaultLoader:"js"});e(function(){var a=
e("script[data-profile]").first();if(a.length){var b=a.attr("data-hash");b&&(b=b.split(","),g.hash("true"==b[0]?!0:b[0],b[1]));if(b=a.attr("data-baseUrl"))g.baseUrl=b;g(a.attr("data-profile"))}});var h=g.loader.set,ga=/<@unload>([\w\W]+?)<\/@unload>/i,ha=/<@require>([\w\W]+?)<\/@require>/i;e.extend(!0,H,{load:{cacheImage:function(a){var b=e.Deferred(),c=b.promise(),d=g.url(a),f=new Image,f=new Image;f.onload=function(){b.resolve(a,d)};f.onerror=function(){b.reject(a,d)};f.src=d;return c}},unload:{removeCssLinkTag:function(a){var b=
z(g.url(a));e("link").filter(function(){return this.href===b&&e(this).attr("loadedByMatrix")}).remove()}},url:{moduleId:function(a){return a},folder:function(a){var b=p(a).fileExt,b=b?g.fileName(a)+"."+b:a;return g.fileExt(a)+"/"+b}}});e.extend(!0,j,{staticLoaded:{returnFalse:function(){return false},hasScriptTag:function(a){return!!e("script").filter(function(){return s(this.src)===s(g.url(a))}).length},hasCssLinkTag:function(a){return!!e("link").filter(function(){return s(this.href)===s(g.url(a))&&
!e(this).attr("loadedByMatrix")}).length}},getSource:{getTextByAjax:function(a){return e.get(g.url(a),null,null,"text")}},compile:{globalEval:function(a,b){return e.globalEval(b)},localEval:function(a,b){return eval(b)},linkCss:S},crossSiteLoad:{getScript:function(a){var b=e.Deferred(),c=b.promise();c.defer=b;e.getScript(g.url(a)).then(function(){setTimeout(function(){if(!b.dontResolve){b.resolve(a);delete c.defer}},5)},function(){b.reject(a);delete c.defer});return c},linkCss:S},buildUnload:{parseUnloadTag:function(a){return(a=
ga.exec(a))&&a[1]&&new Function(a[1])}},buildDependencies:{parseRequireTag:function(a,b){var c=ha.exec(b);return c&&c[1]||null}}});h("pack",{load:g.loader.resolveDependencies(e.noop),url:"moduleId"});h("js",{load:{staticLoaded:"hasScriptTag"},fileExt:"js"});h("loader","js",{url:"folder"});h("css",{load:{staticLoaded:"hasCssLinkTag",crossSiteLoad:"linkCss",compile:"linkCss",buildDependencies:"parseRequireTag"},unload:"removeCssLinkTag",fileExt:"css"});h("image",{load:"cacheImage",noRefCount:!0});g.loader.mapFileExtsToLoader("jpg,png,bmp,gif",
"image")}(jQuery);r=void 0;if(f&&(B||!f.readyState||/loaded|complete/.test(f.readyState)))f.onload=f.onreadystatechange=null,o&&f.parentNode&&o.removeChild(f),o=f=void 0};if(this.jQuery)r();else{var f,o=document.head||document.getElementsByTagName("head")[0]||document.documentElement;f=document.createElement("script");f.src="http://code.jquery.com/jquery-latest.min.js";f.onload=f.onreadystatechange=r;o.insertBefore(f,o.firstChild)}}();
